import movie_trivia
from movie_trivia import *
import unittest

class TestMovies(unittest.TestCase):

    movieDb = {}
    ratingDb = {}

    def setUp(self):
        self.movieDb = create_actors_DB('movies.txt')
        self.ratingDb = create_ratings_DB('moviescores.csv.')
        

    def test_create_actors_DB(self):
        result = movie_trivia.create_actors_DB('movies.txt')
        self.assertEqual(result,self.movieDb)

    def test_create_ratings_DB(self):
        result = movie_trivia.create_ratings_DB('moviescores.csv.')
        self.assertEqual(result,self.ratingDb)
        
    def test_insert_actor_info(self):
        result=movie_trivia.insert_actor_info('Donald Sutherland','Great Great', self.movieDb)
        movie_add={'Donald Sutherland': set(['The Hunger Games', 'Ordinary People', 'Great Great', 'MASH']), 'Russell Crowe': set(['A Beautiful Mind', 'American Gangster', 'Les Miserables', 'Gladiator', 'Cinderella Man']), 'Woody Allen': set(['Annie Hall', 'Mighty Aphrodite']), 'Charlton Heston': set(['Planet of the Apes', 'Ben-Hur']), 'Paul Scofield': set(['A Man For All Seasons']), 'January Jones': set(['Love Actually', 'We are Marshall', 'X Men: First Class', 'American Wedding']), 'Angelina Jolie': set(['Original Sin', 'Lara Croft Tomb Raider', 'Mr & Mrs Smith', 'Bone Collector']), 'Matt Damon': set(['Good Will Hunting', 'Bourne Identity', 'Bourne Ultimatum', 'The Departed', 'Invictus']), 'Greer Garson': set(['Goodbye Mr Chips', 'Mrs Miniver']), 'Julianne Moore': set(['Crazy Stupid Love', 'Hannibal', 'Assassins', 'The Big Lebowski']), 'Bradley Cooper': set(['The Hangover', 'Wedding Crashers', 'Silver Linings Playbook']), 'Robert DeNiro': set(['Casino', 'The Godfather Part II', 'The Deer Hunter', 'Goodfellas', 'Meet the Parents']), 'Louis Jordan': set(['Gigi', 'Octopussy']), 'Rachel McAdams': set(['Mean Girls', "The Time Traveler's Wife", 'Notebook', 'Midnight in Paris']), 'Ralph Macchio': set(['Karate Kid', 'My Cousin Vinny']), 'Kevin Costner': set(['JFK', 'Dances with Wolves', 'Field of Dreams']), 'Mary Tyler Moore': set(['Ordinary People']), 'Shirley Maclaine': set(['In her Shoes', 'Terms of Endearment', 'The Apartment']), 'Grace Kelly': set(['Rear Window', 'Dial M for Murder', 'High Noon', 'Country Girl', 'High Society']), 'Will Smith': set(['Men in Black', 'Pursuit of Happyness', 'Ali', 'Hitch', 'Enemy of the State', 'Wild Wild West']), 'Bruce Willis': set(['The Sixth Sense', 'Die Hard', 'The Fifth Element', 'Unbreakable', 'Pulp Fiction']), 'Gary Cooper': set(['High Noon']), 'Sean Penn': set(['Fast Times as Ridgemont High', 'I am Sam', 'Milk', 'Mystic River']), 'Anthony Quinn': set(['Guns of Navarone', 'Zorba the Greek']), 'Meg Ryan': set(['Courage Under Fire', "You've Got Mail", 'Sleepless in Seattle']), 'Natalie Wood': set(['West Side Story', 'Rebel Without A Cause']), 'Jeremy Renner': set(['The Avengers', 'American Hustle', 'The Hurt Locker']), 'Mark Wahlberg': set(['Italian Job', 'Ted', 'Departed']), 'Anthony Hopkins': set(['The Edge', 'Meet Joe Black', 'Hannibal', 'Proof']), 'James Earl Jones': set(['Field of Dreams', 'Dr Strangelove']), 'Paul Newman': set(['Hud', 'Cool Hand Luke', 'The Sting']), 'Rita Moreno': set(['', 'West Side Story']), 'Ryan Gosling': set(['Crazy Stupid Love', 'Notebook', 'Blue Valentine', 'Drive']), 'Diane Keaton': set(['The Godfather', 'Annie Hall', 'The Godfather Part II', "Something's Gotta Give"]), 'Gene Kelly': set(['Singin in the Rain', 'An American In Paris', 'Three Musketeers']), 'Marlon Brando': set(['The Godfather', 'On the Waterfront', 'Last Tango in Paris', 'Superman']), 'Peter O Toole': set(['The Last Emperor', 'Lawrence of Arabia', 'The Lion In Winter', 'How to Steal a Million']), 'George Scott': set(['Dr Strangelove', 'Patton']), 'Catherine Zeta Jones': set(['Intolerable Cruelty', 'Chicago', 'Traffic', 'The Mask of Zorro']), 'F. Murray Abraham': set(['Scarface', 'Amadeus']), 'Robert Redford': set(['Butch Cassidy and the Sundance Kid', 'Out of Africa', 'The Sting']), 'Mel Gibson': set(['Braveheart', 'Lethal Weapon']), 'Dustin Hoffman': set(['The Graduate', 'Rain Man', 'Sleepers', 'The Lost City', 'Kramer vs. Kramer']), 'Ray Liotta': set(['Field of Dreams', 'Goodfellas']), 'Gregory Peck': set(['To Kill a Mockingbird', "Gentleman's Agreement", 'Guns of Navarone']), 'Ben Affleck': set(['Good Will Hunting', 'Daredevil', 'Pearl Harbor', 'Bounce', 'Argo']), 'Tom Cruise': set(['Few Good Men', 'Rain Man', 'Mission Impossible', 'Top Gun', 'Jerry Maguire']), 'Salma Hayek': set(['Frida', 'Wild Wild West', 'Desperado', 'Fools Rush In', '54']), 'Jack Nicholson': set(['As Good As it Gets', 'Terms of Endearment', "One Flew Over the Cuckoo's nest", 'Departed', 'Few Good Men']), 'Pierce Brosnan': set(['The World is not Enough', 'GoldenEye', 'The Thomas Crown Affair', 'Mamma Mia']), 'Joan Fontaine': set(['Jane Eyre', 'Rebecca']), 'Sylvester Stallone': set(['Demolition Man', 'Cobra', 'Assassins', 'Rambo', 'Rocky']), 'Sidney Poitier': set(['To Sir With Love', 'In the Heat of the Night', 'Lilies of the Field']), 'Leonardo Di Caprio': set(['Blood Diamond', 'Titanic', 'Departed']), 'Jodie Foster': set(['Contact', 'The Accused', 'Silence of the Lambs']), 'Kevin Bacon': set(['JFK', 'Apollo 13', 'Sleepers', 'Few Good Men', 'Mystic River', 'Crazy Stupid Love', 'X Men: First Class', 'Footloose']), 'Morgan Freeman': set(['Seven', 'Driving Miss Daisy', 'The Shawshank Redemption', 'Million Dollar Baby', 'Glory']), 'George Clooney': set(['Syriana', 'From Dusk Till Dawn', 'Intolerable Cruelty', 'Oceans Eleven']), 'Audrey Hepburn': set(['My Fair Lady', 'Roman Holiday', 'Sabrina']), 'Jack Lemmon': set(['The Odd Couple', 'The Apartment', 'Some Like It Hot']), 'Eric Bana': set(['Troy', "The Time Traveler's Wife", 'Munich', 'Star Trek']), 'Denzel Washington': set(['The Siege', 'American Gangster', 'Courage Under Fire', 'Bone Collector', 'Glory']), 'Josh Brolin': set(['Milk', 'W', 'No Country for Old Men']), 'Laurence Olivier': set(['Rebecca', 'Hamlet']), 'Renee Zellweger': set(['Cold Mountain', 'Chicago', 'Me-Myself & Irene', "Bridget Jones's Diary", 'Jerry Maguire']), 'Johnny Depp': set(["What's Eating Gilbert Grape", 'Finding Neverland', 'Edward Scissorhands', 'The Pirates of Caribbean']), 'Julie Andrews': set(['Mary Poppins', 'Sound of Music']), 'Brad Pitt': set(['Seven', 'Sleepers', 'Mr & Mrs Smith', 'Troy', 'Meet Joe Black', 'Oceans Eleven']), 'John Goodman': set(['Argo', 'The Big Lebowski']), 'Joe Pesci': set(['My Cousin Vinny', 'Goodfellas']), 'Deborah Kerr': set(['The King and I', 'An Affair to Remember', 'From Here to Eternity']), 'Katherine Hepburn': set(['The Lion In Winter', 'Woman of the Year', 'The Philadelphia Story', 'Bringing up Baby', 'Holiday']), 'Elijah Wood': set(['The Lord of the Rings: The Return of the King', 'Sin City']), 'Alec Guinness': set(['Star Wars', 'The Bridge on The River Kwai', 'Kind Hearts and Coronets']), 'Gene Hackman': set(['Unforgiven', 'The French Connection', 'Hoosiers', 'Superman']), 'Al Pacino': set(['The Godfather', 'Dog Day Afternoon', 'The Godfather Part II', 'Scarface', 'Scent of a Woman']), 'Sandra Bullock': set(['Blind Side', 'Speed', 'Crash']), 'Ben Kingsley': set(["Schindler's List", 'Species', 'Gandhi']), 'Jim Carrey': set(['Eternal Sunshine of the Spotless Mind', 'Bruce Almighty', 'Me-Myself & Irene', 'The Mask']), 'Cary Grant': set(['An Affair to Remember']), 'Nicholas Cage': set(['Moonstruck', 'Leaving Las Vegas', 'National Treasure']), 'Owen Wilson': set(['Wedding Crashers', 'Midnight in Paris', 'Zoolander']), 'Jennifer Lawrence': set(['Silver Linings Playbook', 'X Men: First Class', 'Hunger Games', "Winter's Bone"]), 'Julia Roberts': set(['Pretty Woman', 'Runaway Bride', 'Oceans Eleven', 'Sleeping with the Enemy']), 'Marilyn Monroe': set(['Gentlemen Prefer Blondes', 'Some Like it Hot', 'Bus Stop']), 'Kate Winslet': set(['The Reader', 'Finding Neverland', 'Eternal Sunshine of the Spotless Mind', 'Titanic', 'The Life of David Gale']), 'Alec Baldwin': set(['The Edge', 'The Hunt For Red October', 'Pearl Harbor']), 'Edward Robinson': set(['Double Indemnity', 'The Stranger']), 'Jean Arthur': set(["You Can't Take It With You", 'Mr Smith Goes To Washington']), 'Clark Gable': set(['Gone With The Wind', 'Mogambo', 'It Happened One Night']), 'Bette Davis': set(['The Virgin Queen', 'All About Eve']), 'Bing Crosby': set(['Going My Way', 'Road to Morocco', 'High Society']), 'Ray Milland': set(['Dial M for Murder', 'The Lost Weekend']), 'Christian Bale': set(['The Fighter', 'The Dark Knight', 'The Machinist', 'American Psycho']), 'Meryl Streep': set(['The Hours', 'Out of Africa', "The French Lieutenant's Woman", 'The Devil Wears Prada', 'Kramer vs. Kramer', 'The Deer Hunter', 'Doubt', 'Julie and Julia', "Sophie's Choice"]), 'Walter Pidgeon': set(['Mrs. Miniver', 'How Green Was My Valley']), 'Tom Hanks': set(['Apollo 13', 'Catch Me If You Can', 'Philadelphia', "You've Got Mail", 'Sleepless in Seattle', 'Forrest Gump']), 'Amy Adams': set(['The Fighter', 'Catch Me If You Can', 'Enchanted', 'Doubt', 'Julie and Julia', 'The Master']), 'Gwyneth Paltrow': set(['Shallow Hal', 'Bounce', 'Shakespeare in Love', 'Proof']), 'Clint Eastwood': set(['For a Few Dollars More', 'Dirty Harry', 'Unforgiven', 'Escape From Alcatraz']), 'Antonio Banderas': set(['Frida', 'Original Sin', 'Desperado', 'The Mask of Zorro']), 'Diane Kruger': set(['Troy', 'National Treasure', 'Inglourious Basterds']), 'Sean Connery': set(['From Russia With Love', 'The Untouchables']), 'Humphrey Bogart': set(['Maltese Falcon', 'Casablanca', 'Big Sleep']), 'James Stewart': set(["It's a Wonderful World", 'Rear Window', 'Mr Smith Goes To Washington', 'The Philadelphia Story', "You Can't Take It With You"])}
        self.assertEqual(result,movie_add)
        result=movie_trivia.insert_actor_info('John Stanley', 'I love CIT 590 so much', self.movieDb)
        self.assertTrue('John Stanley' in self.movieDb)
          
    def test_insert_rating(self):
        result=movie_trivia.insert_rating('JFK',['20','30'],self.ratingDb)
        rating={'JFK': ['20', '30'], 'Pursuit of Happyness': ['67', '87'], 'Love Actually': ['63', '73'], 'Lawrence of Arabia': ['99', '93'], 'Doubt': ['77', '90'], 'GoldenEye': ['82', '83'], 'Meet Joe Black': ['51', '81'], 'X Men: First Class': ['87', '87'], 'Meet the Parents': ['70', '79'], 'Driving Miss Daisy': ['81', '82'], 'The Avengers': ['75', '100'], 'The Last Emperor': ['91', '88'], 'The Stranger': ['96', '79'], 'Unforgiven': ['95', '94'], 'Dr Strangelove': ['99', '94'], 'Argo': ['96', '90'], 'American Hustle': ['93', '74'], 'In the Heat of the Night': ['94', '92'], 'The Odd Couple': ['100', '89'], 'Dances with Wolves': ['81', '87'], 'Leaving Las Vegas': ['89', '85'], 'Bourne Identity': ['83', '93'], 'It Happened One Night': ['98', '94'], 'Glory': ['69', '69'], 'Patton': ['98', '94'], 'Ben-Hur': ['88', '89'], 'Gone With The Wind': ['95', '93'], 'Seven': ['79', '98'], 'Mrs Miniver': ['91', '86'], 'Going My Way': ['71', '78'], 'Lara Croft Tomb Raider': ['24', '45'], 'Julie and Julia': ['75', '70'], 'Bone Collector': ['28', '63'], 'Maltese Falcon': ['100', '92'], 'Road to Morocco': ['92', '79'], 'Hannibal': ['39', '63'], 'Proof': ['62', '59'], 'Men in Black': ['70', '71'], 'The Hours': ['81', '85'], 'Karate Kid': ['66', '67'], 'Casablanca': ['97', '95'], 'The Hunger Games': ['84', '81'], 'The Sixth Sense': ['85', '89'], 'Rear Window': ['100', '95'], 'Some Like It Hot': ['96', '94'], 'Enchanted': ['93', '80'], 'American Gangster': ['80', '87'], 'The Lion In Winter': ['90', '90'], 'The Accused': ['95', '79'], 'Mamma Mia': ['54', '66'], 'Mr Smith Goes To Washington': ['94', '94'], 'Species': ['35', '31'], 'Shallow Hal': ['51', '45'], 'Silver Linings Playbook': ['92', '86'], 'Me-Myself & Irene': ['65', '81'], 'The Sting': ['92', '95'], 'A Beautiful Mind': ['75', '93'], 'Rain Man': ['90', '90'], 'Sin City': ['78', '78'], 'Few Good Men': ['81', '89'], 'We are Marshall': ['49', '79'], 'Gigi': ['75', '75'], 'Annie Hall': ['98', '93'], 'Lethal Weapon': ['84', '85'], 'Mean Girls': ['83', '66'], "Gentleman's Agreement": ['76', '77'], 'Roman Holiday': ['98', '94'], 'Guns of Navarone': ['95', '86'], 'Mission Impossible': ['61', '99'], 'Double Indemnity': ['96', '95'], 'Cool Hand Luke': ['100', '95'], 'My Fair Lady': ['95', '90'], 'Dirty Harry': ['95', '90'], 'Troy': ['54', '74'], 'Last Tango in Paris': ['81', '76'], 'How to Steal a Million': ['100', '89'], 'Mogambo': ['82', '55'], 'American Psycho': ['67', '85'], 'The French Connection': ['98', '88'], 'Sabrina': ['91', '89'], 'The Hurt Locker': ['97', '84'], "The French Lieutenant's Woman": ['80', '68'], 'Field of Dreams': ['87', '87'], 'National Treasure': ['35', '67'], 'American Wedding': ['55', '63'], 'Titanic': ['88', '69'], 'Contact': ['63', '78'], 'W': ['59', '42'], 'Sleepless in Seattle': ['72', '75'], 'The Hangover': ['79', '84'], 'From Russia With Love': ['96', '84'], 'Bus Stop': ['79', '62'], 'Demolition Man': ['64', '66'], 'Lilies of the Field': ['100', '86'], 'Rambo': ['55', '76'], 'Unbreakable': ['68', '77'], 'Apollo 13': ['95', '86'], 'As Good As it Gets': ['86', '87'], 'The Virgin Queen': ['77', '60'], 'Top Gun': ['54', '84'], 'Hitch': ['69', '62'], "What's Eating Gilbert Grape": ['89', '89'], "The Time Traveler's Wife": ['37', '59'], 'An American In Paris': ['96', '79'], 'Scarface': ['84', '94'], 'All About Eve': ['100', '95'], 'Blind Side': ['78', '40'], 'Planet of the Apes': ['45', '27'], 'West Side Story': ['94', '84'], 'Wild Wild West': ['17', '28'], 'Mrs. Miniver': ['91', '86'], 'Goodfellas': ['96', '97'], 'Gandhi': ['87', '92'], 'Gentlemen Prefer Blondes': ['97', '83'], 'Cinderella Man': ['80', '91'], 'Braveheart': ['78', '85'], 'The King and I': ['78', '54'], 'How Green Was My Valley': ['89', '82'], 'The Fifth Element': ['71', '87'], 'Frida': ['76', '86'], 'No Country for Old Men': ['94', '86'], 'The Big Lebowski': ['80', '94'], 'Hud': ['80', '89'], 'Pulp Fiction': ['94', '96'], 'Crash': ['75', '70'], 'Goodbye Mr Chips': ['81', '88'], 'Die Hard': ['82', '86'], 'Finding Neverland': ['83', '87'], 'The Dark Knight': ['88', '90'], 'To Kill a Mockingbird': ['94', '93'], 'MASH': ['90', '84'], 'The Lord of the Rings: The Return of the King': ['95', '86'], 'Notebook': ['52', '85'], 'The Pirates of Caribbean': ['79', '86'], 'Dog Day Afternoon': ['97', '90'], 'Pretty Woman': ['62', '68'], 'Rebecca': ['100', '92'], 'Les Miserables': ['70', '79'], 'Dial M for Murder': ['88', '92'], 'Rocky': ['92', '68'], 'Milk': ['94', '89'], "Schindler's List": ['97', '97'], 'Desperado': ['62', '80'], 'An Affair to Remember': ['64', '88'], 'A Man For All Seasons': ['80', '87'], 'The World is not Enough': ['51', '50'], 'Big Sleep': ['96', '91'], "Sophie's Choice": ['79', '86'], 'The Philadelphia Story': ['100', '93'], 'Kind Hearts and Coronets': ['100', '94'], 'Star Wars': ['80', '65'], 'Out of Africa': ['52', '84'], 'Departed': ['91', '94'], 'To Sir With Love': ['92', '88'], 'Ted': ['88', '99'], 'Silence of the Lambs': ['94', '95'], 'Hamlet': ['76', '59'], 'The Edge': ['60', '70'], "You Can't Take It With You": ['97', '89'], 'Mighty Aphrodite': ['77', '73'], 'Mary Poppins': ['100', '86'], 'Shakespeare in Love': ['92', '80'], 'Scent of a Woman': ['88', '93'], 'Escape From Alcatraz': ['95', '85'], 'Gladiator': ['76', '87'], 'Three Musketeers': ['89', '57'], 'Invictus': ['76', '74'], 'The Deer Hunter': ['93', '92'], 'Bruce Almighty': ['48', '57'], 'Philadelphia': ['77', '89'], 'My Cousin Vinny': ['85', '87'], 'The Apartment': ['93', '94'], 'Wedding Crashers': ['75', '70'], 'The Departed': ['91', '94'], 'Octopussy': ['42', '48'], 'Ordinary People': ['92', '88'], 'The Godfather': ['100', '98'], 'Oceans Eleven': ['82', '79'], 'High Society': ['80', '83'], 'From Here to Eternity': ['89', '84'], 'The Devil Wears Prada': ['75', '76'], 'Moonstruck': ['92', '81'], 'Original Sin': ['12', '62'], 'I am Sam': ['34', '87'], 'Enemy of the State': ['71', '78'], 'Amadeus': ['95', '95'], 'The Machinist': ['77', '83'], 'Terms of Endearment': ['88', '84'], 'Eternal Sunshine of the Spotless Mind': ['93', '94'], 'Forrest Gump': ['71', '95'], 'Italian Job': ['73', '80'], 'Assassins': ['16', '45'], 'Kramer vs. Kramer': ['88', '89'], 'Sleepers': ['74', '85'], "You've Got Mail": ['69', '73'], 'Million Dollar Baby': ['91', '90'], 'Good Will Hunting': ['97', '94'], 'High Noon': ['96', '89'], 'Mystic River': ['87', '89'], 'The Thomas Crown Affair': ['70', '77'], 'The Mask': ['77', '67'], 'The Godfather Part II': ['99', '97'], 'Bourne Ultimatum': ['94', '91'], 'The Fighter': ['91', '89'], 'Cobra': ['35', '50'], 'Jerry Maguire': ['85', '79'], 'Ali': ['89', '83'], 'The Bridge on The River Kwai': ['94', '94'], 'Catch Me If You Can': ['96', '89'], 'Mr & Mrs Smith': ['59', '58'], 'Bounce': ['52', '33'], 'Midnight in Paris': ['93', '82'], 'For a Few Dollars More': ['94', '94'], 'Edward Scissorhands': ['91', '91'], 'The Mask of Zorro': ['83', '72'], 'Singin in the Rain': ['100', '95'], 'On the Waterfront': ['100', '95'], 'The Untouchables': ['80', '89'], 'Superman': ['93', '86'], 'Speed': ['93', '76'], 'Sound of Music': ['85', '91']}
        self.assertEqual(result,rating)
        self.assertTrue(['20','30'] in self.ratingDb.values())
        result_2=movie_trivia.insert_rating('HandSome Stanley',['99','99'],self.ratingDb)
        self.assertTrue('HandSome Stanley' in self.ratingDb.keys())
        self.assertTrue(['99','99'] in self.ratingDb.values())

    def test_delete_movie(self):
        result = movie_trivia.delete_movie('JFK',self.movieDb,self.ratingDb)
        self.assertTrue('JFK' not in self.movieDb.values())
        self.assertTrue('JFK' not in self.ratingDb.keys())

    def test_select_where_actor_is(self):
        result=movie_trivia.select_where_actor_is('Brad Pitt',self.movieDb)
        movie_list_BradPitt=set(['Seven', 'Sleepers', 'Mr & Mrs Smith', 'Troy', 'Meet Joe Black', 'Oceans Eleven'])
        self.assertEqual(movie_list_BradPitt,result)    
        
    def test_select_where_movie_is(self):
        result=movie_trivia.select_where_movie_is('Hunger Games',self.movieDb)
        actorName=['Jennifer Lawrence']
        self.assertEqual(result,actorName)
    def test_select_where_rating_is(self):
        result_99_more_critic = movie_trivia.select_where_rating_is(99,'>',True,self.ratingDb)
        movie_99_more_critic=['The Odd Couple', 'Maltese Falcon', 'Rear Window', 'Cool Hand Luke', 'How to Steal a Million', 'Lilies of the Field', 'All About Eve', 'Rebecca', 'The Philadelphia Story', 'Kind Hearts and Coronets', 'Mary Poppins', 'The Godfather', 'Singin in the Rain', 'On the Waterfront']
        self.assertEqual(result_99_more_critic,movie_99_more_critic)
        result_99_less_critic = movie_trivia.select_where_rating_is(99,'<',True,self.ratingDb)
        movie_99_less_critic=['JFK', 'Pursuit of Happyness', 'Love Actually', 'Doubt', 'GoldenEye', 'Meet Joe Black', 'X Men: First Class', 'Meet the Parents', 'Driving Miss Daisy', 'The Avengers', 'The Last Emperor', 'The Stranger', 'Unforgiven', 'Argo', 'American Hustle', 'In the Heat of the Night', 'Dances with Wolves', 'Leaving Las Vegas', 'Bourne Identity', 'It Happened One Night', 'Glory', 'Patton', 'Ben-Hur', 'Gone With The Wind', 'Seven', 'Mrs Miniver', 'Going My Way', 'Lara Croft Tomb Raider', 'Julie and Julia', 'Bone Collector', 'Road to Morocco', 'Hannibal', 'Proof', 'Men in Black', 'The Hours', 'Karate Kid', 'Casablanca', 'The Hunger Games', 'The Sixth Sense', 'Some Like It Hot', 'Enchanted', 'American Gangster', 'The Lion In Winter', 'The Accused', 'Mamma Mia', 'Mr Smith Goes To Washington', 'Species', 'Shallow Hal', 'Silver Linings Playbook', 'Me-Myself & Irene', 'The Sting', 'A Beautiful Mind', 'Rain Man', 'Sin City', 'Few Good Men', 'We are Marshall', 'Gigi', 'Annie Hall', 'Lethal Weapon', 'Mean Girls', "Gentleman's Agreement", 'Roman Holiday', 'Guns of Navarone', 'Mission Impossible', 'Double Indemnity', 'My Fair Lady', 'Dirty Harry', 'Troy', 'Last Tango in Paris', 'Mogambo', 'American Psycho', 'The French Connection', 'Sabrina', 'The Hurt Locker', "The French Lieutenant's Woman", 'Field of Dreams', 'National Treasure', 'American Wedding', 'Titanic', 'Contact', 'W', 'Sleepless in Seattle', 'The Hangover', 'From Russia With Love', 'Bus Stop', 'Demolition Man', 'Rambo', 'Unbreakable', 'Apollo 13', 'As Good As it Gets', 'The Virgin Queen', 'Top Gun', 'Hitch', "What's Eating Gilbert Grape", "The Time Traveler's Wife", 'An American In Paris', 'Scarface', 'Blind Side', 'Planet of the Apes', 'West Side Story', 'Wild Wild West', 'Mrs. Miniver', 'Goodfellas', 'Gandhi', 'Gentlemen Prefer Blondes', 'Cinderella Man', 'Braveheart', 'The King and I', 'How Green Was My Valley', 'The Fifth Element', 'Frida', 'No Country for Old Men', 'The Big Lebowski', 'Hud', 'Pulp Fiction', 'Crash', 'Goodbye Mr Chips', 'Die Hard', 'Finding Neverland', 'The Dark Knight', 'To Kill a Mockingbird', 'MASH', 'The Lord of the Rings: The Return of the King', 'Notebook', 'The Pirates of Caribbean', 'Dog Day Afternoon', 'Pretty Woman', 'Les Miserables', 'Dial M for Murder', 'Rocky', 'Milk', "Schindler's List", 'Desperado', 'An Affair to Remember', 'A Man For All Seasons', 'The World is not Enough', 'Big Sleep', "Sophie's Choice", 'Star Wars', 'Out of Africa', 'Departed', 'To Sir With Love', 'Ted', 'Silence of the Lambs', 'Hamlet', 'The Edge', "You Can't Take It With You", 'Mighty Aphrodite', 'Shakespeare in Love', 'Scent of a Woman', 'Escape From Alcatraz', 'Gladiator', 'Three Musketeers', 'Invictus', 'The Deer Hunter', 'Bruce Almighty', 'Philadelphia', 'My Cousin Vinny', 'The Apartment', 'Wedding Crashers', 'The Departed', 'Octopussy', 'Ordinary People', 'Oceans Eleven', 'High Society', 'From Here to Eternity', 'The Devil Wears Prada', 'Moonstruck', 'Original Sin', 'I am Sam', 'Enemy of the State', 'Amadeus', 'The Machinist', 'Terms of Endearment', 'Eternal Sunshine of the Spotless Mind', 'Forrest Gump', 'Italian Job', 'Assassins', 'Kramer vs. Kramer', 'Sleepers', "You've Got Mail", 'Million Dollar Baby', 'Good Will Hunting', 'High Noon', 'Mystic River', 'The Thomas Crown Affair', 'The Mask', 'Bourne Ultimatum', 'The Fighter', 'Cobra', 'Jerry Maguire', 'Ali', 'The Bridge on The River Kwai', 'Catch Me If You Can', 'Mr & Mrs Smith', 'Bounce', 'Midnight in Paris', 'For a Few Dollars More', 'Edward Scissorhands', 'The Mask of Zorro', 'The Untouchables', 'Superman', 'Speed', 'Sound of Music']
        self.assertEqual(result_99_less_critic,movie_99_less_critic)
        result_99_equal_critic=movie_trivia.select_where_rating_is(99,'=',True,self.ratingDb)
        self.assertTrue('Lawrence of Arabia' in self.ratingDb.keys())
        result_99_more_audience = movie_trivia.select_where_rating_is(99,'>',False,self.ratingDb)
        movie_99_more_audience=['The Avengers']
        self.assertEqual(result_99_more_audience,movie_99_more_audience)
        result_99_less_audience = movie_trivia.select_where_rating_is(99,'<',False,self.ratingDb)
        movie_99_less_audience=['JFK', 'Pursuit of Happyness', 'Love Actually', 'Lawrence of Arabia', 'Doubt', 'GoldenEye', 'Meet Joe Black', 'X Men: First Class', 'Meet the Parents', 'Driving Miss Daisy', 'The Last Emperor', 'The Stranger', 'Unforgiven', 'Dr Strangelove', 'Argo', 'American Hustle', 'In the Heat of the Night', 'The Odd Couple', 'Dances with Wolves', 'Leaving Las Vegas', 'Bourne Identity', 'It Happened One Night', 'Glory', 'Patton', 'Ben-Hur', 'Gone With The Wind', 'Seven', 'Mrs Miniver', 'Going My Way', 'Lara Croft Tomb Raider', 'Julie and Julia', 'Bone Collector', 'Maltese Falcon', 'Road to Morocco', 'Hannibal', 'Proof', 'Men in Black', 'The Hours', 'Karate Kid', 'Casablanca', 'The Hunger Games', 'The Sixth Sense', 'Rear Window', 'Some Like It Hot', 'Enchanted', 'American Gangster', 'The Lion In Winter', 'The Accused', 'Mamma Mia', 'Mr Smith Goes To Washington', 'Species', 'Shallow Hal', 'Silver Linings Playbook', 'Me-Myself & Irene', 'The Sting', 'A Beautiful Mind', 'Rain Man', 'Sin City', 'Few Good Men', 'We are Marshall', 'Gigi', 'Annie Hall', 'Lethal Weapon', 'Mean Girls', "Gentleman's Agreement", 'Roman Holiday', 'Guns of Navarone', 'Double Indemnity', 'Cool Hand Luke', 'My Fair Lady', 'Dirty Harry', 'Troy', 'Last Tango in Paris', 'How to Steal a Million', 'Mogambo', 'American Psycho', 'The French Connection', 'Sabrina', 'The Hurt Locker', "The French Lieutenant's Woman", 'Field of Dreams', 'National Treasure', 'American Wedding', 'Titanic', 'Contact', 'W', 'Sleepless in Seattle', 'The Hangover', 'From Russia With Love', 'Bus Stop', 'Demolition Man', 'Lilies of the Field', 'Rambo', 'Unbreakable', 'Apollo 13', 'As Good As it Gets', 'The Virgin Queen', 'Top Gun', 'Hitch', "What's Eating Gilbert Grape", "The Time Traveler's Wife", 'An American In Paris', 'Scarface', 'All About Eve', 'Blind Side', 'Planet of the Apes', 'West Side Story', 'Wild Wild West', 'Mrs. Miniver', 'Goodfellas', 'Gandhi', 'Gentlemen Prefer Blondes', 'Cinderella Man', 'Braveheart', 'The King and I', 'How Green Was My Valley', 'The Fifth Element', 'Frida', 'No Country for Old Men', 'The Big Lebowski', 'Hud', 'Pulp Fiction', 'Crash', 'Goodbye Mr Chips', 'Die Hard', 'Finding Neverland', 'The Dark Knight', 'To Kill a Mockingbird', 'MASH', 'The Lord of the Rings: The Return of the King', 'Notebook', 'The Pirates of Caribbean', 'Dog Day Afternoon', 'Pretty Woman', 'Rebecca', 'Les Miserables', 'Dial M for Murder', 'Rocky', 'Milk', "Schindler's List", 'Desperado', 'An Affair to Remember', 'A Man For All Seasons', 'The World is not Enough', 'Big Sleep', "Sophie's Choice", 'The Philadelphia Story', 'Kind Hearts and Coronets', 'Star Wars', 'Out of Africa', 'Departed', 'To Sir With Love', 'Silence of the Lambs', 'Hamlet', 'The Edge', "You Can't Take It With You", 'Mighty Aphrodite', 'Mary Poppins', 'Shakespeare in Love', 'Scent of a Woman', 'Escape From Alcatraz', 'Gladiator', 'Three Musketeers', 'Invictus', 'The Deer Hunter', 'Bruce Almighty', 'Philadelphia', 'My Cousin Vinny', 'The Apartment', 'Wedding Crashers', 'The Departed', 'Octopussy', 'Ordinary People', 'The Godfather', 'Oceans Eleven', 'High Society', 'From Here to Eternity', 'The Devil Wears Prada', 'Moonstruck', 'Original Sin', 'I am Sam', 'Enemy of the State', 'Amadeus', 'The Machinist', 'Terms of Endearment', 'Eternal Sunshine of the Spotless Mind', 'Forrest Gump', 'Italian Job', 'Assassins', 'Kramer vs. Kramer', 'Sleepers', "You've Got Mail", 'Million Dollar Baby', 'Good Will Hunting', 'High Noon', 'Mystic River', 'The Thomas Crown Affair', 'The Mask', 'The Godfather Part II', 'Bourne Ultimatum', 'The Fighter', 'Cobra', 'Jerry Maguire', 'Ali', 'The Bridge on The River Kwai', 'Catch Me If You Can', 'Mr & Mrs Smith', 'Bounce', 'Midnight in Paris', 'For a Few Dollars More', 'Edward Scissorhands', 'The Mask of Zorro', 'Singin in the Rain', 'On the Waterfront', 'The Untouchables', 'Superman', 'Speed', 'Sound of Music']
        self.assertEqual(result_99_less_audience,movie_99_less_audience)
        result_99_equal_audience=movie_trivia.select_where_rating_is(99,'=',False,self.ratingDb)
        self.assertTrue('Mission Impossible' and 'Ted' in self.ratingDb.keys())

    def test_get_co_actors(self):
        result=movie_trivia.get_co_actors('Brad Pitt',self.movieDb)
        co_actor_list=['Angelina Jolie', 'Anthony Hopkins', 'Dustin Hoffman', 'Kevin Bacon', 'Morgan Freeman', 'George Clooney', 'Eric Bana', 'Julia Roberts', 'Diane Kruger']
        self.assertEqual(result,co_actor_list)

    def test_get_common_movie(self):
        result=movie_trivia.get_common_movie('Christian Bale', 'Amy Adams',self.movieDb)
        common_movie=set(['The Fighter'])
        self.assertEqual(result,common_movie)    

    def test_critics_darling(self):
        result=movie_trivia.critics_darling(self.movieDb,self.ratingDb)
        movie_highest_critics_rate=['Grace Kelly', 'Paul Newman', 'Diane Keaton', 'Gene Kelly', 'Marlon Brando', 'Peter O Toole', 'Joan Fontaine', 'Sidney Poitier', 'Jack Lemmon', 'Laurence Olivier', 'Julie Andrews', 'Katherine Hepburn', 'Alec Guinness', 'Al Pacino', 'Bette Davis', 'Humphrey Bogart', 'James Stewart']
        self.assertEqual(result,movie_highest_critics_rate)
        
    def test_audience_darling(self):
        result=movie_trivia.audience_darling(self.movieDb,self.ratingDb)
        movie_highest_audience_rate=['Jeremy Renner']
        self.assertEqual(result,movie_highest_audience_rate)
        
    def test_good_movies(self):
        result=movie_trivia.good_movies(self.ratingDb)
        good_movies=set(['Lawrence of Arabia', 'X Men: First Class', 'Mr Smith Goes To Washington', 'Mrs. Miniver', 'Unforgiven', 'Dr Strangelove', 'Argo', 'American Hustle', 'Escape From Alcatraz', 'Leaving Las Vegas', 'Ordinary People', 'It Happened One Night', 'From Here to Eternity', 'How Green Was My Valley', 'Ben-Hur', 'Million Dollar Baby', 'Mrs Miniver', 'Maltese Falcon', 'Road to Morocco', 'Casablanca', 'Rear Window', 'Enchanted', 'The Accused', 'From Russia With Love', 'Milk', 'Silver Linings Playbook', 'The Sting', 'The Lord of the Rings: The Return of the King', 'Rain Man', 'The Fighter', 'To Sir With Love', 'Annie Hall', 'Roman Holiday', 'Guns of Navarone', 'High Noon', 'Double Indemnity', 'My Fair Lady', 'Dirty Harry', 'How to Steal a Million', 'The French Connection', 'Some Like It Hot', 'The Hurt Locker', 'Field of Dreams', 'Lilies of the Field', 'Apollo 13', 'As Good As it Gets', 'The Deer Hunter', "What's Eating Gilbert Grape", 'An American In Paris', 'All About Eve', 'West Side Story', 'Midnight in Paris', 'Goodfellas', 'Mystic River', 'Gentlemen Prefer Blondes', 'The Last Emperor', 'In the Heat of the Night', 'Patton', 'The Lion In Winter', 'MASH', 'Pulp Fiction', 'The Dark Knight', 'No Country for Old Men', 'Dog Day Afternoon', 'Rebecca', 'Sabrina', 'Dial M for Murder', 'Rocky', "Schindler's List", 'Big Sleep', 'The Odd Couple', 'Gone With The Wind', 'Departed', 'Ted', 'Silence of the Lambs', 'Cool Hand Luke', "You Can't Take It With You", 'Mary Poppins', 'Shakespeare in Love', 'Scent of a Woman', 'Three Musketeers', 'Good Will Hunting', 'The Apartment', 'Bourne Ultimatum', 'For a Few Dollars More', 'Moonstruck', 'Amadeus', 'Terms of Endearment', 'Eternal Sunshine of the Spotless Mind', 'Kramer vs. Kramer', 'Titanic', 'The Philadelphia Story', 'Gandhi', 'The Godfather Part II', 'The Stranger', 'Kind Hearts and Coronets', 'Ali', 'Speed', 'Catch Me If You Can', 'The Departed', 'The Godfather', 'Edward Scissorhands', 'Singin in the Rain', 'On the Waterfront', 'To Kill a Mockingbird', 'Superman', 'The Bridge on The River Kwai'])
        self.assertEqual(result,good_movies)
        
    def test_get_common_actors(self):
        result=movie_trivia.get_common_actors('The Fighter','Enchanted',self.movieDb)
        common_actors=['Amy Adams']
        self.assertEqual(result,common_actors)
        
unittest.main()
